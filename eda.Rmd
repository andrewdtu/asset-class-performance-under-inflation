---
title: "mileston2"
author: "Andrew Tu"
date: "3/11/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set() 

library(tidyverse)
library(ggplot2)
library(ggthemes)
library(lubridate)
#interest <- read_csv('https://github.com/andrewdtu/stat479group3/blob/main/stock.csv?raw=true')
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r wrangle}
interest <- read_csv('stock.csv')%>%
  mutate(Date = as_datetime(Date))

interest$EFFR[which(interest$EFFR == ".")] <- NA 

interest_2 <-interest%>%
  drop_na()%>%
  mutate(perc_change = ((Close-Open)/Open)*100)%>%
  mutate(EFFR = as.numeric(EFFR))%>%
  group_by(ticker)%>%
  ungroup()
```

```{r close, fig.height = 15, fig.width = 8}


ggplot(interest_2, aes(x=Date,y=Close,color = as.numeric(EFFR)))+
    geom_line(aes(),size = 1)+
    facet_grid(ticker~.,scales = 'free_y')+
    scale_color_viridis_c(option = 'inferno')

```

```{r effr}
ggplot(interest_2,aes(x=Date,y=EFFR))+
  geom_line(Size = 2)
```

```{r 2 periods}
period_1_start = as_datetime('2005-01-12')
period_1_end = as_datetime('2007-06-15')
period_2_start = as_datetime('2017-01-03')
period_2_end = as_datetime('2020-02-03')

interest_periods <- interest_2%>%
  filter(!ticker %in% c('XOP','XME','GDX'))%>%
  select(ticker,Date,Close)%>%
  filter(Date %in% c(period_1_start,period_1_end,period_2_start,period_2_end))%>%
  pivot_wider(names_from = Date, values_from = Close)%>%
  mutate(period_1_return = (`2007-06-15`-`2005-01-12`)/`2005-01-12`)%>%
  mutate(period_2_return = (`2020-02-03`-`2017-01-03`)/`2017-01-03`)
ggplot(interest_periods, aes(period_1_return,period_2_return,color = ticker))+
  geom_point(size = 5)+
  scale_color_tableau()

```